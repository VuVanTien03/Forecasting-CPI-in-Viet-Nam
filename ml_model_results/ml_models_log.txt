2025-05-17 01:27:02,460 - INFO - Kiểm tra NaN/Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 01:27:02,463 - INFO - Kiểm tra Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 01:27:02,466 - INFO - Kích thước dữ liệu gốc: 349
2025-05-17 01:27:02,467 - INFO - Tạo đặc trưng cho cpi_mom, kích thước dữ liệu: (349, 17)
2025-05-17 01:27:02,478 - INFO - Đã thêm đặc trưng mùa vụ
2025-05-17 01:27:02,506 - INFO - Loại bỏ đặc trưng tương quan thấp (< 0.5): ['cpi_yoy', 'gold_price', 'interest_rate', 'cpi_yoy_smoothed', 'cpi_yoy_log', 'year', 'cpi_mom_diff', 'cpi_mom_rolling_mean', 'cpi_mom_rolling_std', 'cpi_yoy_rolling_mean', 'cpi_yoy_rolling_std', 'cpi_mom_lag_2', 'cpi_mom_lag_3', 'cpi_mom_lag_4', 'cpi_mom_lag_5', 'cpi_mom_lag_6', 'cpi_mom_lag_7', 'cpi_mom_lag_8', 'cpi_mom_lag_9', 'cpi_mom_lag_10', 'cpi_mom_lag_11', 'cpi_mom_lag_12', 'oil_price_lag_1', 'oil_price_lag_2', 'oil_price_lag_3', 'oil_price_lag_4', 'oil_price_lag_5', 'oil_price_lag_6', 'oil_price_lag_7', 'oil_price_lag_8', 'oil_price_lag_9', 'oil_price_lag_10', 'oil_price_lag_11', 'oil_price_lag_12', 'oil_price_roll_mean_3', 'oil_price_roll_mean_6', 'month_1', 'month_2', 'month_3', 'month_4', 'month_5', 'month_6', 'month_7', 'month_8', 'month_9', 'month_10', 'month_11', 'month_12', 'month_sin', 'month_cos', 'quarter']
2025-05-17 01:27:02,622 - INFO - PCA: 4 thành phần, tỷ lệ phương sai: 0.9900
2025-05-17 01:27:02,623 - INFO - Đặc trưng sau xử lý: ['cpi_mom', 'oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:27:02,623 - INFO - Kích thước tập dữ liệu: Train=337, Test=12
2025-05-17 01:27:02,624 - INFO - Đặc trưng cho cpi_mom: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:27:02,634 - INFO - Chạy các mô hình cho cpi_mom
2025-05-17 01:27:02,634 - INFO - Chạy Random Forest cho cpi_mom
2025-05-17 01:27:02,642 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:27:02,643 - INFO - Chạy Random Forest cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:27:14,582 - INFO - Tham số tốt nhất: {'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 10, 'min_samples_split': 10, 'n_estimators': 52}, CV RMSE: 0.4820
2025-05-17 01:27:14,906 - INFO - Đã lưu biểu đồ: cpi_mom_random_forest_forecast.png
2025-05-17 01:27:18,449 - INFO - Đã lưu learning curves: cpi_mom_random_forest_learning_curve.png
2025-05-17 01:27:18,449 - INFO - Overfitting gap cho Random Forest (cpi_mom): 0.0469
2025-05-17 01:27:18,449 - INFO - Random Forest (cpi_mom): Train RMSE=0.3884, Test RMSE=0.2290, CV RMSE=0.4820, Test MAE=0.1661, Test MAPE=0.1656, Best Params={'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 10, 'min_samples_split': 10, 'n_estimators': 52}, Overfitting Gap=0.0469, Time=15.81s
2025-05-17 01:27:18,449 - INFO - Hoàn thành Random Forest trong 15.81s
2025-05-17 01:27:18,449 - INFO - Chạy XGBoost cho cpi_mom
2025-05-17 01:27:18,456 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:27:18,456 - INFO - Chạy XGBoost cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:27:25,697 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, CV RMSE: 0.3662
2025-05-17 01:27:26,007 - INFO - Đã lưu biểu đồ: cpi_mom_xgboost_forecast.png
2025-05-17 01:27:28,613 - INFO - Đã lưu learning curves: cpi_mom_xgboost_learning_curve.png
2025-05-17 01:27:28,613 - INFO - Overfitting gap cho XGBoost (cpi_mom): -0.1197
2025-05-17 01:27:28,613 - INFO - XGBoost (cpi_mom): Train RMSE=0.2598, Test RMSE=0.1934, CV RMSE=0.3662, Test MAE=0.1500, Test MAPE=0.1494, Best Params={'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, Overfitting Gap=-0.1197, Time=10.16s
2025-05-17 01:27:28,613 - INFO - Hoàn thành XGBoost trong 10.16s
2025-05-17 01:27:28,613 - INFO - Chạy LightGBM cho cpi_mom
2025-05-17 01:27:28,619 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:27:28,620 - INFO - Chạy LightGBM cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:27:32,344 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, CV RMSE: 0.4286
2025-05-17 01:27:32,623 - INFO - Đã lưu biểu đồ: cpi_mom_lightgbm_forecast.png
2025-05-17 01:27:33,474 - INFO - Đã lưu learning curves: cpi_mom_lightgbm_learning_curve.png
2025-05-17 01:27:33,474 - INFO - Overfitting gap cho LightGBM (cpi_mom): 0.0252
2025-05-17 01:27:33,474 - INFO - LightGBM (cpi_mom): Train RMSE=0.3235, Test RMSE=0.1795, CV RMSE=0.4286, Test MAE=0.1322, Test MAPE=0.1316, Best Params={'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, Overfitting Gap=0.0252, Time=4.86s
2025-05-17 01:27:33,475 - INFO - Hoàn thành LightGBM trong 4.86s
2025-05-17 01:27:33,475 - INFO - Chạy SVR cho cpi_mom
2025-05-17 01:27:33,481 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:27:33,481 - INFO - Chạy SVR cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:27:34,935 - INFO - Tham số tốt nhất: {'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, CV RMSE: 0.4036
2025-05-17 01:27:35,186 - INFO - Đã lưu biểu đồ: cpi_mom_svr_forecast.png
2025-05-17 01:27:35,562 - INFO - Đã lưu learning curves: cpi_mom_svr_learning_curve.png
2025-05-17 01:27:35,562 - INFO - Overfitting gap cho SVR (cpi_mom): -0.1132
2025-05-17 01:27:35,562 - INFO - SVR (cpi_mom): Train RMSE=0.2406, Test RMSE=0.1973, CV RMSE=0.4036, Test MAE=0.1307, Test MAPE=0.1300, Best Params={'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, Overfitting Gap=-0.1132, Time=2.09s
2025-05-17 01:27:35,562 - INFO - Hoàn thành SVR trong 2.09s
2025-05-17 01:27:35,562 - INFO - Chạy ElasticNet cho cpi_mom
2025-05-17 01:27:35,569 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:27:35,571 - INFO - Chạy ElasticNet cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:27:35,997 - INFO - Tham số tốt nhất: {'alpha': 0.06024145688620425, 'l1_ratio': 0.3325152889039984}, CV RMSE: 0.2862
2025-05-17 01:27:36,292 - INFO - Đã lưu biểu đồ: cpi_mom_elasticnet_forecast.png
2025-05-17 01:27:36,691 - INFO - Đã lưu learning curves: cpi_mom_elasticnet_learning_curve.png
2025-05-17 01:27:36,691 - INFO - Overfitting gap cho ElasticNet (cpi_mom): 0.1367
2025-05-17 01:27:36,691 - INFO - ElasticNet (cpi_mom): Train RMSE=0.3267, Test RMSE=0.2047, CV RMSE=0.2862, Test MAE=0.1559, Test MAPE=0.1552, Best Params={'alpha': 0.06024145688620425, 'l1_ratio': 0.3325152889039984}, Overfitting Gap=0.1367, Time=1.13s
2025-05-17 01:27:36,691 - INFO - Hoàn thành ElasticNet trong 1.13s
2025-05-17 01:27:36,691 - INFO - Chạy Linear Regression cho cpi_mom
2025-05-17 01:27:36,698 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:27:36,699 - INFO - Chạy Linear Regression cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:27:36,973 - INFO - Đã lưu biểu đồ: cpi_mom_linear_regression_forecast.png
2025-05-17 01:27:37,409 - INFO - Đã lưu learning curves: cpi_mom_linear_regression_learning_curve.png
2025-05-17 01:27:37,409 - INFO - Overfitting gap cho Linear Regression (cpi_mom): -1.1440
2025-05-17 01:27:37,409 - INFO - Linear Regression (cpi_mom): Train RMSE=0.3204, Test RMSE=0.2035, CV RMSE=0.3516, Test MAE=0.1426, Test MAPE=0.1419, Best Params={}, Overfitting Gap=-1.1440, Time=0.72s
2025-05-17 01:27:37,409 - INFO - Hoàn thành Linear Regression trong 0.72s
2025-05-17 01:27:37,409 - INFO - Chạy Ridge cho cpi_mom
2025-05-17 01:27:37,416 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:27:37,418 - INFO - Chạy Ridge cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:27:37,770 - INFO - Tham số tốt nhất: {'alpha': 15.061457009902096}, CV RMSE: 0.2860
2025-05-17 01:27:37,989 - INFO - Đã lưu biểu đồ: cpi_mom_ridge_forecast.png
2025-05-17 01:27:38,396 - INFO - Đã lưu learning curves: cpi_mom_ridge_learning_curve.png
2025-05-17 01:27:38,396 - INFO - Overfitting gap cho Ridge (cpi_mom): 0.1621
2025-05-17 01:27:38,396 - INFO - Ridge (cpi_mom): Train RMSE=0.3218, Test RMSE=0.2040, CV RMSE=0.2860, Test MAE=0.1469, Test MAPE=0.1463, Best Params={'alpha': 15.061457009902096}, Overfitting Gap=0.1621, Time=0.99s
2025-05-17 01:27:38,396 - INFO - Hoàn thành Ridge trong 0.99s
2025-05-17 01:27:38,834 - INFO - Đã lưu biểu đồ so sánh: cpi_mom_ml_model_comparison.png
2025-05-17 01:27:38,841 - INFO - Kết quả lưu tại ml_model_results\ml_model_results.csv
2025-05-17 01:27:38,843 - INFO - Tham số tối ưu lưu tại ml_model_results\best_params.csv
2025-05-17 01:27:38,846 - INFO - Dự báo kết hợp lưu tại ml_model_results/combined_forecast_cpi_mom.csv
2025-05-17 01:28:36,370 - INFO - Kiểm tra NaN/Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 01:28:36,371 - INFO - Kiểm tra Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 01:28:36,372 - INFO - Kích thước dữ liệu gốc: 349
2025-05-17 01:28:36,372 - INFO - Tạo đặc trưng cho cpi_mom, kích thước dữ liệu: (349, 17)
2025-05-17 01:28:36,387 - INFO - Đã thêm đặc trưng mùa vụ
2025-05-17 01:28:36,414 - INFO - Loại bỏ đặc trưng tương quan thấp (< 0.5): ['cpi_yoy', 'gold_price', 'interest_rate', 'cpi_yoy_smoothed', 'cpi_yoy_log', 'year', 'cpi_mom_diff', 'cpi_mom_rolling_mean', 'cpi_mom_rolling_std', 'cpi_yoy_rolling_mean', 'cpi_yoy_rolling_std', 'cpi_mom_lag_2', 'cpi_mom_lag_3', 'cpi_mom_lag_4', 'cpi_mom_lag_5', 'cpi_mom_lag_6', 'cpi_mom_lag_7', 'cpi_mom_lag_8', 'cpi_mom_lag_9', 'cpi_mom_lag_10', 'cpi_mom_lag_11', 'cpi_mom_lag_12', 'cpi_mom_roll_mean_12', 'oil_price_lag_1', 'oil_price_lag_2', 'oil_price_lag_3', 'oil_price_lag_4', 'oil_price_lag_5', 'oil_price_lag_6', 'oil_price_lag_7', 'oil_price_lag_8', 'oil_price_lag_9', 'oil_price_lag_10', 'oil_price_lag_11', 'oil_price_lag_12', 'oil_price_roll_mean_3', 'oil_price_roll_mean_6', 'oil_price_roll_mean_12', 'month_1', 'month_2', 'month_3', 'month_4', 'month_5', 'month_6', 'month_7', 'month_8', 'month_9', 'month_10', 'month_11', 'month_12', 'month_sin', 'month_cos', 'quarter']
2025-05-17 01:28:36,419 - INFO - PCA: 4 thành phần, tỷ lệ phương sai: 0.9900
2025-05-17 01:28:36,420 - INFO - Đặc trưng sau xử lý: ['cpi_mom', 'oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:28:36,420 - INFO - Kích thước tập dữ liệu: Train=337, Test=12
2025-05-17 01:28:36,420 - INFO - Đặc trưng cho cpi_mom: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:28:36,431 - INFO - Chạy các mô hình cho cpi_mom
2025-05-17 01:28:36,431 - INFO - Chạy Random Forest cho cpi_mom
2025-05-17 01:28:36,439 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:28:36,440 - INFO - Chạy Random Forest cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:29:06,220 - INFO - Tham số tốt nhất: {'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 5, 'min_samples_split': 10, 'n_estimators': 67}, CV RMSE: 0.4558
2025-05-17 01:29:06,549 - INFO - Đã lưu biểu đồ: cpi_mom_random_forest_forecast.png
2025-05-17 01:29:10,895 - INFO - Đã lưu learning curves: cpi_mom_random_forest_learning_curve.png
2025-05-17 01:29:10,895 - INFO - Overfitting gap cho Random Forest (cpi_mom): -0.0407
2025-05-17 01:29:10,895 - INFO - Random Forest (cpi_mom): Train RMSE=0.3331, Test RMSE=0.2271, CV RMSE=0.4558, Test MAE=0.1649, Test MAPE=0.1643, Best Params={'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 5, 'min_samples_split': 10, 'n_estimators': 67}, Overfitting Gap=-0.0407, Time=34.46s
2025-05-17 01:29:10,895 - INFO - Hoàn thành Random Forest trong 34.46s
2025-05-17 01:29:10,895 - INFO - Chạy XGBoost cho cpi_mom
2025-05-17 01:29:10,903 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:29:10,904 - INFO - Chạy XGBoost cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:29:22,729 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, CV RMSE: 0.3662
2025-05-17 01:29:22,976 - INFO - Đã lưu biểu đồ: cpi_mom_xgboost_forecast.png
2025-05-17 01:29:25,479 - INFO - Đã lưu learning curves: cpi_mom_xgboost_learning_curve.png
2025-05-17 01:29:25,479 - INFO - Overfitting gap cho XGBoost (cpi_mom): -0.1197
2025-05-17 01:29:25,479 - INFO - XGBoost (cpi_mom): Train RMSE=0.2598, Test RMSE=0.1934, CV RMSE=0.3662, Test MAE=0.1500, Test MAPE=0.1494, Best Params={'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, Overfitting Gap=-0.1197, Time=14.58s
2025-05-17 01:29:25,479 - INFO - Hoàn thành XGBoost trong 14.58s
2025-05-17 01:29:25,479 - INFO - Chạy LightGBM cho cpi_mom
2025-05-17 01:29:25,485 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:29:25,486 - INFO - Chạy LightGBM cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:29:29,312 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.8481681145550304, 'lambda_l1': 1.394113546106644, 'lambda_l2': 2.3323439229142995, 'learning_rate': 0.04720852615282812, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 82, 'subsample': 0.8627620691664697}, CV RMSE: 0.4173
2025-05-17 01:29:29,572 - INFO - Đã lưu biểu đồ: cpi_mom_lightgbm_forecast.png
2025-05-17 01:29:30,449 - INFO - Đã lưu learning curves: cpi_mom_lightgbm_learning_curve.png
2025-05-17 01:29:30,449 - INFO - Overfitting gap cho LightGBM (cpi_mom): -0.0049
2025-05-17 01:29:30,449 - INFO - LightGBM (cpi_mom): Train RMSE=0.3108, Test RMSE=0.1717, CV RMSE=0.4173, Test MAE=0.1271, Test MAPE=0.1266, Best Params={'colsample_bytree': 0.8481681145550304, 'lambda_l1': 1.394113546106644, 'lambda_l2': 2.3323439229142995, 'learning_rate': 0.04720852615282812, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 82, 'subsample': 0.8627620691664697}, Overfitting Gap=-0.0049, Time=4.97s
2025-05-17 01:29:30,450 - INFO - Hoàn thành LightGBM trong 4.97s
2025-05-17 01:29:30,450 - INFO - Chạy SVR cho cpi_mom
2025-05-17 01:29:30,455 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:29:30,456 - INFO - Chạy SVR cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:29:33,783 - INFO - Tham số tốt nhất: {'C': 1.3709563372047595, 'epsilon': 0.020789142699330444, 'kernel': 'rbf'}, CV RMSE: 0.3952
2025-05-17 01:29:34,011 - INFO - Đã lưu biểu đồ: cpi_mom_svr_forecast.png
2025-05-17 01:29:34,415 - INFO - Đã lưu learning curves: cpi_mom_svr_learning_curve.png
2025-05-17 01:29:34,415 - INFO - Overfitting gap cho SVR (cpi_mom): -0.1288
2025-05-17 01:29:34,415 - INFO - SVR (cpi_mom): Train RMSE=0.2239, Test RMSE=0.2019, CV RMSE=0.3952, Test MAE=0.1275, Test MAPE=0.1268, Best Params={'C': 1.3709563372047595, 'epsilon': 0.020789142699330444, 'kernel': 'rbf'}, Overfitting Gap=-0.1288, Time=3.97s
2025-05-17 01:29:34,415 - INFO - Hoàn thành SVR trong 3.97s
2025-05-17 01:29:34,415 - INFO - Chạy ElasticNet cho cpi_mom
2025-05-17 01:29:34,422 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:29:34,423 - INFO - Chạy ElasticNet cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:29:35,337 - INFO - Tham số tốt nhất: {'alpha': 0.06024145688620425, 'l1_ratio': 0.3325152889039984}, CV RMSE: 0.2862
2025-05-17 01:29:35,551 - INFO - Đã lưu biểu đồ: cpi_mom_elasticnet_forecast.png
2025-05-17 01:29:35,930 - INFO - Đã lưu learning curves: cpi_mom_elasticnet_learning_curve.png
2025-05-17 01:29:35,931 - INFO - Overfitting gap cho ElasticNet (cpi_mom): 0.1367
2025-05-17 01:29:35,931 - INFO - ElasticNet (cpi_mom): Train RMSE=0.3267, Test RMSE=0.2047, CV RMSE=0.2862, Test MAE=0.1559, Test MAPE=0.1552, Best Params={'alpha': 0.06024145688620425, 'l1_ratio': 0.3325152889039984}, Overfitting Gap=0.1367, Time=1.52s
2025-05-17 01:29:35,931 - INFO - Hoàn thành ElasticNet trong 1.52s
2025-05-17 01:29:35,931 - INFO - Chạy Linear Regression cho cpi_mom
2025-05-17 01:29:35,938 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:29:35,939 - INFO - Chạy Linear Regression cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:29:36,159 - INFO - Đã lưu biểu đồ: cpi_mom_linear_regression_forecast.png
2025-05-17 01:29:36,548 - INFO - Đã lưu learning curves: cpi_mom_linear_regression_learning_curve.png
2025-05-17 01:29:36,548 - INFO - Overfitting gap cho Linear Regression (cpi_mom): -1.1440
2025-05-17 01:29:36,548 - INFO - Linear Regression (cpi_mom): Train RMSE=0.3204, Test RMSE=0.2035, CV RMSE=0.3516, Test MAE=0.1426, Test MAPE=0.1419, Best Params={}, Overfitting Gap=-1.1440, Time=0.62s
2025-05-17 01:29:36,548 - INFO - Hoàn thành Linear Regression trong 0.62s
2025-05-17 01:29:36,548 - INFO - Chạy Ridge cho cpi_mom
2025-05-17 01:29:36,554 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:29:36,555 - INFO - Chạy Ridge cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:29:37,324 - INFO - Tham số tốt nhất: {'alpha': 13.438999080000846}, CV RMSE: 0.2859
2025-05-17 01:29:37,528 - INFO - Đã lưu biểu đồ: cpi_mom_ridge_forecast.png
2025-05-17 01:29:37,894 - INFO - Đã lưu learning curves: cpi_mom_ridge_learning_curve.png
2025-05-17 01:29:37,894 - INFO - Overfitting gap cho Ridge (cpi_mom): 0.1596
2025-05-17 01:29:37,894 - INFO - Ridge (cpi_mom): Train RMSE=0.3215, Test RMSE=0.2038, CV RMSE=0.2859, Test MAE=0.1463, Test MAPE=0.1456, Best Params={'alpha': 13.438999080000846}, Overfitting Gap=0.1596, Time=1.35s
2025-05-17 01:29:37,894 - INFO - Hoàn thành Ridge trong 1.35s
2025-05-17 01:29:38,168 - INFO - Đã lưu biểu đồ so sánh: cpi_mom_ml_model_comparison.png
2025-05-17 01:29:38,173 - INFO - Kết quả lưu tại ml_model_results\ml_model_results.csv
2025-05-17 01:29:38,174 - INFO - Tham số tối ưu lưu tại ml_model_results\best_params.csv
2025-05-17 01:29:38,178 - INFO - Dự báo kết hợp lưu tại ml_model_results/combined_forecast_cpi_mom.csv
2025-05-17 01:32:39,349 - INFO - Kiểm tra NaN/Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 01:32:39,350 - INFO - Kiểm tra Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 01:32:39,351 - INFO - Kích thước dữ liệu gốc: 349
2025-05-17 01:32:39,351 - INFO - Tạo đặc trưng cho cpi_mom, kích thước dữ liệu: (349, 17)
2025-05-17 01:32:39,362 - INFO - Đã thêm đặc trưng mùa vụ
2025-05-17 01:32:39,394 - INFO - Loại bỏ đặc trưng tương quan thấp (< 0.5): ['cpi_yoy', 'gold_price', 'interest_rate', 'cpi_yoy_smoothed', 'cpi_yoy_log', 'year', 'cpi_mom_diff', 'cpi_mom_rolling_mean', 'cpi_mom_rolling_std', 'cpi_yoy_rolling_mean', 'cpi_yoy_rolling_std', 'cpi_mom_lag_2', 'cpi_mom_lag_3', 'cpi_mom_lag_4', 'cpi_mom_lag_5', 'cpi_mom_lag_6', 'cpi_mom_lag_7', 'cpi_mom_lag_8', 'cpi_mom_lag_9', 'cpi_mom_lag_10', 'cpi_mom_lag_11', 'cpi_mom_lag_12', 'cpi_mom_roll_mean_12', 'oil_price_lag_1', 'oil_price_lag_2', 'oil_price_lag_3', 'oil_price_lag_4', 'oil_price_lag_5', 'oil_price_lag_6', 'oil_price_lag_7', 'oil_price_lag_8', 'oil_price_lag_9', 'oil_price_lag_10', 'oil_price_lag_11', 'oil_price_lag_12', 'oil_price_roll_mean_3', 'oil_price_roll_mean_6', 'oil_price_roll_mean_12', 'month_1', 'month_2', 'month_3', 'month_4', 'month_5', 'month_6', 'month_7', 'month_8', 'month_9', 'month_10', 'month_11', 'month_12', 'month_sin', 'month_cos', 'quarter']
2025-05-17 01:32:39,399 - INFO - PCA: 4 thành phần, tỷ lệ phương sai: 0.9900
2025-05-17 01:32:39,400 - INFO - Đặc trưng sau xử lý: ['cpi_mom', 'oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:32:39,400 - INFO - Kích thước tập dữ liệu: Train=337, Test=12
2025-05-17 01:32:39,400 - INFO - Đặc trưng cho cpi_mom: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:32:39,409 - INFO - Chạy các mô hình cho cpi_mom
2025-05-17 01:32:39,410 - INFO - Chạy Random Forest cho cpi_mom
2025-05-17 01:32:39,416 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:32:39,417 - INFO - Chạy Random Forest cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:33:13,888 - INFO - Tham số tốt nhất: {'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 5, 'min_samples_split': 10, 'n_estimators': 67}, CV RMSE: 0.4558
2025-05-17 01:33:14,375 - INFO - Đã lưu biểu đồ: cpi_mom_random_forest_forecast.png
2025-05-17 01:33:19,873 - INFO - Đã lưu learning curves: cpi_mom_random_forest_learning_curve.png
2025-05-17 01:33:19,873 - INFO - Overfitting gap cho Random Forest (cpi_mom): -0.0407
2025-05-17 01:33:19,873 - INFO - Random Forest (cpi_mom): Train RMSE=0.3331, Test RMSE=0.2271, CV RMSE=0.4558, Test MAE=0.1649, Test MAPE=0.1643, Best Params={'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 5, 'min_samples_split': 10, 'n_estimators': 67}, Overfitting Gap=-0.0407, Time=40.46s
2025-05-17 01:33:19,874 - INFO - Hoàn thành Random Forest trong 40.46s
2025-05-17 01:33:19,874 - INFO - Chạy XGBoost cho cpi_mom
2025-05-17 01:33:19,880 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:33:19,882 - INFO - Chạy XGBoost cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:33:34,149 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, CV RMSE: 0.3662
2025-05-17 01:33:34,444 - INFO - Đã lưu biểu đồ: cpi_mom_xgboost_forecast.png
2025-05-17 01:33:37,224 - INFO - Đã lưu learning curves: cpi_mom_xgboost_learning_curve.png
2025-05-17 01:33:37,224 - INFO - Overfitting gap cho XGBoost (cpi_mom): -0.1197
2025-05-17 01:33:37,224 - INFO - XGBoost (cpi_mom): Train RMSE=0.2598, Test RMSE=0.1934, CV RMSE=0.3662, Test MAE=0.1500, Test MAPE=0.1494, Best Params={'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, Overfitting Gap=-0.1197, Time=17.35s
2025-05-17 01:33:37,224 - INFO - Hoàn thành XGBoost trong 17.35s
2025-05-17 01:33:37,224 - INFO - Chạy LightGBM cho cpi_mom
2025-05-17 01:33:37,234 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:33:37,236 - INFO - Chạy LightGBM cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:33:41,917 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.8481681145550304, 'lambda_l1': 1.394113546106644, 'lambda_l2': 2.3323439229142995, 'learning_rate': 0.04720852615282812, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 82, 'subsample': 0.8627620691664697}, CV RMSE: 0.4173
2025-05-17 01:33:42,189 - INFO - Đã lưu biểu đồ: cpi_mom_lightgbm_forecast.png
2025-05-17 01:33:43,126 - INFO - Đã lưu learning curves: cpi_mom_lightgbm_learning_curve.png
2025-05-17 01:33:43,126 - INFO - Overfitting gap cho LightGBM (cpi_mom): -0.0049
2025-05-17 01:33:43,126 - INFO - LightGBM (cpi_mom): Train RMSE=0.3108, Test RMSE=0.1717, CV RMSE=0.4173, Test MAE=0.1271, Test MAPE=0.1266, Best Params={'colsample_bytree': 0.8481681145550304, 'lambda_l1': 1.394113546106644, 'lambda_l2': 2.3323439229142995, 'learning_rate': 0.04720852615282812, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 82, 'subsample': 0.8627620691664697}, Overfitting Gap=-0.0049, Time=5.90s
2025-05-17 01:33:43,126 - INFO - Hoàn thành LightGBM trong 5.90s
2025-05-17 01:33:43,126 - INFO - Chạy SVR cho cpi_mom
2025-05-17 01:33:43,133 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:33:43,134 - INFO - Chạy SVR cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:33:47,000 - INFO - Tham số tốt nhất: {'C': 1.3709563372047595, 'epsilon': 0.020789142699330444, 'kernel': 'rbf'}, CV RMSE: 0.3952
2025-05-17 01:33:47,404 - INFO - Đã lưu biểu đồ: cpi_mom_svr_forecast.png
2025-05-17 01:33:48,065 - INFO - Đã lưu learning curves: cpi_mom_svr_learning_curve.png
2025-05-17 01:33:48,065 - INFO - Overfitting gap cho SVR (cpi_mom): -0.1288
2025-05-17 01:33:48,065 - INFO - SVR (cpi_mom): Train RMSE=0.2239, Test RMSE=0.2019, CV RMSE=0.3952, Test MAE=0.1275, Test MAPE=0.1268, Best Params={'C': 1.3709563372047595, 'epsilon': 0.020789142699330444, 'kernel': 'rbf'}, Overfitting Gap=-0.1288, Time=4.94s
2025-05-17 01:33:48,065 - INFO - Hoàn thành SVR trong 4.94s
2025-05-17 01:33:48,065 - INFO - Chạy ElasticNet cho cpi_mom
2025-05-17 01:33:48,075 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:33:48,077 - INFO - Chạy ElasticNet cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:33:49,624 - INFO - Tham số tốt nhất: {'alpha': 0.06024145688620425, 'l1_ratio': 0.3325152889039984}, CV RMSE: 0.2862
2025-05-17 01:33:49,997 - INFO - Đã lưu biểu đồ: cpi_mom_elasticnet_forecast.png
2025-05-17 01:33:50,642 - INFO - Đã lưu learning curves: cpi_mom_elasticnet_learning_curve.png
2025-05-17 01:33:50,642 - INFO - Overfitting gap cho ElasticNet (cpi_mom): 0.1367
2025-05-17 01:33:50,642 - INFO - ElasticNet (cpi_mom): Train RMSE=0.3267, Test RMSE=0.2047, CV RMSE=0.2862, Test MAE=0.1559, Test MAPE=0.1552, Best Params={'alpha': 0.06024145688620425, 'l1_ratio': 0.3325152889039984}, Overfitting Gap=0.1367, Time=2.58s
2025-05-17 01:33:50,643 - INFO - Hoàn thành ElasticNet trong 2.58s
2025-05-17 01:33:50,643 - INFO - Chạy Linear Regression cho cpi_mom
2025-05-17 01:33:50,655 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:33:50,658 - INFO - Chạy Linear Regression cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:33:51,018 - INFO - Đã lưu biểu đồ: cpi_mom_linear_regression_forecast.png
2025-05-17 01:33:51,613 - INFO - Đã lưu learning curves: cpi_mom_linear_regression_learning_curve.png
2025-05-17 01:33:51,613 - INFO - Overfitting gap cho Linear Regression (cpi_mom): -1.1440
2025-05-17 01:33:51,614 - INFO - Linear Regression (cpi_mom): Train RMSE=0.3204, Test RMSE=0.2035, CV RMSE=0.3516, Test MAE=0.1426, Test MAPE=0.1419, Best Params={}, Overfitting Gap=-1.1440, Time=0.97s
2025-05-17 01:33:51,614 - INFO - Hoàn thành Linear Regression trong 0.97s
2025-05-17 01:33:51,614 - INFO - Chạy Ridge cho cpi_mom
2025-05-17 01:33:51,622 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:33:51,625 - INFO - Chạy Ridge cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:33:52,967 - INFO - Tham số tốt nhất: {'alpha': 13.438999080000846}, CV RMSE: 0.2859
2025-05-17 01:33:53,349 - INFO - Đã lưu biểu đồ: cpi_mom_ridge_forecast.png
2025-05-17 01:33:53,862 - INFO - Đã lưu learning curves: cpi_mom_ridge_learning_curve.png
2025-05-17 01:33:53,862 - INFO - Overfitting gap cho Ridge (cpi_mom): 0.1596
2025-05-17 01:33:53,863 - INFO - Ridge (cpi_mom): Train RMSE=0.3215, Test RMSE=0.2038, CV RMSE=0.2859, Test MAE=0.1463, Test MAPE=0.1456, Best Params={'alpha': 13.438999080000846}, Overfitting Gap=0.1596, Time=2.25s
2025-05-17 01:33:53,863 - INFO - Hoàn thành Ridge trong 2.25s
2025-05-17 01:33:54,151 - INFO - Đã lưu biểu đồ so sánh: cpi_mom_ml_model_comparison.png
2025-05-17 01:33:54,155 - INFO - Kết quả lưu tại ml_model_results\ml_model_results.csv
2025-05-17 01:33:54,156 - INFO - Tham số tối ưu lưu tại ml_model_results\best_params.csv
2025-05-17 01:33:54,160 - INFO - Dự báo kết hợp lưu tại ml_model_results/combined_forecast_cpi_mom.csv
2025-05-17 01:37:20,751 - INFO - Kiểm tra NaN/Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 01:37:20,752 - INFO - Kiểm tra Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 01:37:20,753 - INFO - Kích thước dữ liệu gốc: 349
2025-05-17 01:37:20,753 - INFO - Tạo đặc trưng cho cpi_mom, kích thước dữ liệu: (349, 17)
2025-05-17 01:37:20,766 - INFO - Đã thêm đặc trưng mùa vụ
2025-05-17 01:37:20,794 - INFO - Loại bỏ đặc trưng tương quan thấp (< 0.5): ['cpi_yoy', 'gold_price', 'interest_rate', 'cpi_yoy_smoothed', 'cpi_yoy_log', 'year', 'cpi_mom_diff', 'cpi_mom_rolling_mean', 'cpi_mom_rolling_std', 'cpi_yoy_rolling_mean', 'cpi_yoy_rolling_std', 'cpi_mom_lag_2', 'cpi_mom_lag_3', 'cpi_mom_lag_4', 'cpi_mom_lag_5', 'cpi_mom_lag_6', 'cpi_mom_lag_7', 'cpi_mom_lag_8', 'cpi_mom_lag_9', 'cpi_mom_lag_10', 'cpi_mom_lag_11', 'cpi_mom_lag_12', 'cpi_mom_roll_mean_12', 'oil_price_lag_1', 'oil_price_lag_2', 'oil_price_lag_3', 'oil_price_lag_4', 'oil_price_lag_5', 'oil_price_lag_6', 'oil_price_lag_7', 'oil_price_lag_8', 'oil_price_lag_9', 'oil_price_lag_10', 'oil_price_lag_11', 'oil_price_lag_12', 'oil_price_roll_mean_3', 'oil_price_roll_mean_6', 'oil_price_roll_mean_12', 'month_1', 'month_2', 'month_3', 'month_4', 'month_5', 'month_6', 'month_7', 'month_8', 'month_9', 'month_10', 'month_11', 'month_12', 'month_sin', 'month_cos', 'quarter']
2025-05-17 01:37:20,798 - INFO - PCA: 4 thành phần, tỷ lệ phương sai: 0.9900
2025-05-17 01:37:20,799 - INFO - Đặc trưng sau xử lý: ['cpi_mom', 'oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:37:20,799 - INFO - Kích thước tập dữ liệu: Train=337, Test=12
2025-05-17 01:37:20,799 - INFO - Đặc trưng cho cpi_mom: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:37:20,808 - INFO - Chạy các mô hình cho cpi_mom
2025-05-17 01:37:20,809 - INFO - Chạy Random Forest cho cpi_mom
2025-05-17 01:37:20,815 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:37:20,816 - INFO - Chạy Random Forest cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:37:32,614 - INFO - Tham số tốt nhất: {'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 10, 'min_samples_split': 10, 'n_estimators': 52}, CV RMSE: 0.4820
2025-05-17 01:37:32,914 - INFO - Đã lưu biểu đồ: cpi_mom_random_forest_forecast.png
2025-05-17 01:37:36,113 - INFO - Đã lưu learning curves: cpi_mom_random_forest_learning_curve.png
2025-05-17 01:37:36,113 - INFO - Overfitting gap cho Random Forest (cpi_mom): 0.0469
2025-05-17 01:37:36,113 - INFO - Random Forest (cpi_mom): Train RMSE=0.3884, Test RMSE=0.2290, CV RMSE=0.4820, Test MAE=0.1661, Test MAPE=0.1656, Best Params={'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 10, 'min_samples_split': 10, 'n_estimators': 52}, Overfitting Gap=0.0469, Time=15.30s
2025-05-17 01:37:36,113 - INFO - Hoàn thành Random Forest trong 15.30s
2025-05-17 01:37:36,113 - INFO - Chạy XGBoost cho cpi_mom
2025-05-17 01:37:36,119 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:37:36,120 - INFO - Chạy XGBoost cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:37:41,331 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, CV RMSE: 0.3662
2025-05-17 01:37:41,605 - INFO - Đã lưu biểu đồ: cpi_mom_xgboost_forecast.png
2025-05-17 01:37:44,436 - INFO - Đã lưu learning curves: cpi_mom_xgboost_learning_curve.png
2025-05-17 01:37:44,436 - INFO - Overfitting gap cho XGBoost (cpi_mom): -0.1197
2025-05-17 01:37:44,436 - INFO - XGBoost (cpi_mom): Train RMSE=0.2598, Test RMSE=0.1934, CV RMSE=0.3662, Test MAE=0.1500, Test MAPE=0.1494, Best Params={'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, Overfitting Gap=-0.1197, Time=8.32s
2025-05-17 01:37:44,436 - INFO - Hoàn thành XGBoost trong 8.32s
2025-05-17 01:37:44,437 - INFO - Chạy LightGBM cho cpi_mom
2025-05-17 01:37:44,444 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:37:44,445 - INFO - Chạy LightGBM cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:37:46,019 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, CV RMSE: 0.4286
2025-05-17 01:37:46,389 - INFO - Đã lưu biểu đồ: cpi_mom_lightgbm_forecast.png
2025-05-17 01:37:47,240 - INFO - Đã lưu learning curves: cpi_mom_lightgbm_learning_curve.png
2025-05-17 01:37:47,240 - INFO - Overfitting gap cho LightGBM (cpi_mom): 0.0252
2025-05-17 01:37:47,240 - INFO - LightGBM (cpi_mom): Train RMSE=0.3235, Test RMSE=0.1795, CV RMSE=0.4286, Test MAE=0.1322, Test MAPE=0.1316, Best Params={'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, Overfitting Gap=0.0252, Time=2.80s
2025-05-17 01:37:47,240 - INFO - Hoàn thành LightGBM trong 2.80s
2025-05-17 01:37:47,240 - INFO - Chạy SVR cho cpi_mom
2025-05-17 01:37:47,246 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:37:47,247 - INFO - Chạy SVR cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:37:48,624 - INFO - Tham số tốt nhất: {'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, CV RMSE: 0.4036
2025-05-17 01:37:48,862 - INFO - Đã lưu biểu đồ: cpi_mom_svr_forecast.png
2025-05-17 01:37:49,328 - INFO - Đã lưu learning curves: cpi_mom_svr_learning_curve.png
2025-05-17 01:37:49,328 - INFO - Overfitting gap cho SVR (cpi_mom): -0.1132
2025-05-17 01:37:49,328 - INFO - SVR (cpi_mom): Train RMSE=0.2406, Test RMSE=0.1973, CV RMSE=0.4036, Test MAE=0.1307, Test MAPE=0.1300, Best Params={'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, Overfitting Gap=-0.1132, Time=2.09s
2025-05-17 01:37:49,328 - INFO - Hoàn thành SVR trong 2.09s
2025-05-17 01:37:49,328 - INFO - Chạy ElasticNet cho cpi_mom
2025-05-17 01:37:49,336 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:37:49,337 - INFO - Chạy ElasticNet cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:37:49,884 - INFO - Tham số tốt nhất: {'alpha': 0.06024145688620425, 'l1_ratio': 0.3325152889039984}, CV RMSE: 0.2862
2025-05-17 01:37:50,158 - INFO - Đã lưu biểu đồ: cpi_mom_elasticnet_forecast.png
2025-05-17 01:37:50,578 - INFO - Đã lưu learning curves: cpi_mom_elasticnet_learning_curve.png
2025-05-17 01:37:50,578 - INFO - Overfitting gap cho ElasticNet (cpi_mom): 0.1367
2025-05-17 01:37:50,578 - INFO - ElasticNet (cpi_mom): Train RMSE=0.3267, Test RMSE=0.2047, CV RMSE=0.2862, Test MAE=0.1559, Test MAPE=0.1552, Best Params={'alpha': 0.06024145688620425, 'l1_ratio': 0.3325152889039984}, Overfitting Gap=0.1367, Time=1.25s
2025-05-17 01:37:50,578 - INFO - Hoàn thành ElasticNet trong 1.25s
2025-05-17 01:37:50,578 - INFO - Chạy Linear Regression cho cpi_mom
2025-05-17 01:37:50,588 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:37:50,591 - INFO - Chạy Linear Regression cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:37:51,057 - INFO - Đã lưu biểu đồ: cpi_mom_linear_regression_forecast.png
2025-05-17 01:37:51,507 - INFO - Đã lưu learning curves: cpi_mom_linear_regression_learning_curve.png
2025-05-17 01:37:51,507 - INFO - Overfitting gap cho Linear Regression (cpi_mom): -1.1440
2025-05-17 01:37:51,508 - INFO - Linear Regression (cpi_mom): Train RMSE=0.3204, Test RMSE=0.2035, CV RMSE=0.3516, Test MAE=0.1426, Test MAPE=0.1419, Best Params={}, Overfitting Gap=-1.1440, Time=0.93s
2025-05-17 01:37:51,508 - INFO - Hoàn thành Linear Regression trong 0.93s
2025-05-17 01:37:51,508 - INFO - Chạy Ridge cho cpi_mom
2025-05-17 01:37:51,513 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 01:37:51,514 - INFO - Chạy Ridge cho cpi_mom, X_train shape: (337, 5)
2025-05-17 01:37:51,958 - INFO - Tham số tốt nhất: {'alpha': 15.061457009902096}, CV RMSE: 0.2860
2025-05-17 01:37:52,219 - INFO - Đã lưu biểu đồ: cpi_mom_ridge_forecast.png
2025-05-17 01:37:52,643 - INFO - Đã lưu learning curves: cpi_mom_ridge_learning_curve.png
2025-05-17 01:37:52,643 - INFO - Overfitting gap cho Ridge (cpi_mom): 0.1621
2025-05-17 01:37:52,643 - INFO - Ridge (cpi_mom): Train RMSE=0.3218, Test RMSE=0.2040, CV RMSE=0.2860, Test MAE=0.1469, Test MAPE=0.1463, Best Params={'alpha': 15.061457009902096}, Overfitting Gap=0.1621, Time=1.14s
2025-05-17 01:37:52,643 - INFO - Hoàn thành Ridge trong 1.14s
2025-05-17 01:37:53,041 - INFO - Đã lưu biểu đồ so sánh: cpi_mom_ml_model_comparison.png
2025-05-17 01:37:53,046 - INFO - Kết quả lưu tại ml_model_results\ml_model_results.csv
2025-05-17 01:37:53,047 - INFO - Tham số tối ưu lưu tại ml_model_results\best_params.csv
2025-05-17 01:37:53,051 - INFO - Dự báo kết hợp lưu tại ml_model_results/combined_forecast_cpi_mom.csv
2025-05-17 15:00:15,102 - INFO - Kiểm tra NaN/Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 15:00:15,105 - INFO - Kiểm tra Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 15:00:15,118 - INFO - Kích thước dữ liệu gốc: 349
2025-05-17 15:00:15,118 - INFO - Tạo đặc trưng cho cpi_mom, kích thước dữ liệu: (349, 17)
2025-05-17 15:00:15,143 - INFO - Đã thêm đặc trưng mùa vụ
2025-05-17 15:00:15,183 - INFO - Loại bỏ đặc trưng tương quan thấp (< 0.5): ['cpi_yoy', 'gold_price', 'interest_rate', 'cpi_yoy_smoothed', 'cpi_yoy_log', 'year', 'cpi_mom_diff', 'cpi_mom_rolling_mean', 'cpi_mom_rolling_std', 'cpi_yoy_rolling_mean', 'cpi_yoy_rolling_std', 'cpi_mom_lag_2', 'cpi_mom_lag_3', 'cpi_mom_lag_4', 'cpi_mom_lag_5', 'cpi_mom_lag_6', 'cpi_mom_lag_7', 'cpi_mom_lag_8', 'cpi_mom_lag_9', 'cpi_mom_lag_10', 'cpi_mom_lag_11', 'cpi_mom_lag_12', 'oil_price_lag_1', 'oil_price_lag_2', 'oil_price_lag_3', 'oil_price_lag_4', 'oil_price_lag_5', 'oil_price_lag_6', 'oil_price_lag_7', 'oil_price_lag_8', 'oil_price_lag_9', 'oil_price_lag_10', 'oil_price_lag_11', 'oil_price_lag_12', 'oil_price_roll_mean_3', 'oil_price_roll_mean_6', 'month_1', 'month_2', 'month_3', 'month_4', 'month_5', 'month_6', 'month_7', 'month_8', 'month_9', 'month_10', 'month_11', 'month_12', 'month_sin', 'month_cos', 'quarter']
2025-05-17 15:00:15,490 - INFO - PCA: 4 thành phần, tỷ lệ phương sai: 0.9900
2025-05-17 15:00:15,491 - INFO - Đặc trưng sau xử lý: ['cpi_mom', 'oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:00:15,496 - INFO - Kích thước tập dữ liệu: Train=337, Test=12
2025-05-17 15:00:15,503 - INFO - Đặc trưng cho cpi_mom: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:00:15,512 - INFO - Chạy các mô hình cho cpi_mom
2025-05-17 15:00:15,512 - INFO - Chạy XGBoost cho cpi_mom
2025-05-17 15:00:15,529 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:00:15,531 - INFO - Chạy XGBoost cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:00:26,221 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, CV RMSE: 0.3662
2025-05-17 15:00:26,729 - INFO - Đã lưu biểu đồ: cpi_mom_xgboost_forecast.png
2025-05-17 15:00:29,903 - INFO - Đã lưu learning curves: cpi_mom_xgboost_learning_curve.png
2025-05-17 15:00:29,904 - INFO - Overfitting gap cho XGBoost (cpi_mom): -0.1197
2025-05-17 15:00:29,904 - INFO - XGBoost (cpi_mom): Train RMSE=0.2598, Test RMSE=0.1934, CV RMSE=0.3662, Test MAE=0.1500, Test MAPE=0.1494, Best Params={'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, Overfitting Gap=-0.1197, Time=14.39s
2025-05-17 15:00:29,904 - INFO - Hoàn thành XGBoost trong 14.39s
2025-05-17 15:00:29,905 - INFO - Chạy LightGBM cho cpi_mom
2025-05-17 15:00:29,913 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:00:29,913 - INFO - Chạy LightGBM cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:00:34,746 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, CV RMSE: 0.4286
2025-05-17 15:00:35,060 - INFO - Đã lưu biểu đồ: cpi_mom_lightgbm_forecast.png
2025-05-17 15:00:36,016 - INFO - Đã lưu learning curves: cpi_mom_lightgbm_learning_curve.png
2025-05-17 15:00:36,016 - INFO - Overfitting gap cho LightGBM (cpi_mom): 0.0252
2025-05-17 15:00:36,016 - INFO - LightGBM (cpi_mom): Train RMSE=0.3235, Test RMSE=0.1795, CV RMSE=0.4286, Test MAE=0.1322, Test MAPE=0.1316, Best Params={'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, Overfitting Gap=0.0252, Time=6.11s
2025-05-17 15:00:36,016 - INFO - Hoàn thành LightGBM trong 6.11s
2025-05-17 15:00:36,016 - INFO - Chạy SVR cho cpi_mom
2025-05-17 15:00:36,026 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:00:36,027 - INFO - Chạy SVR cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:00:37,530 - INFO - Tham số tốt nhất: {'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, CV RMSE: 0.4036
2025-05-17 15:00:37,785 - INFO - Đã lưu biểu đồ: cpi_mom_svr_forecast.png
2025-05-17 15:00:38,210 - INFO - Đã lưu learning curves: cpi_mom_svr_learning_curve.png
2025-05-17 15:00:38,210 - INFO - Overfitting gap cho SVR (cpi_mom): -0.1132
2025-05-17 15:00:38,210 - INFO - SVR (cpi_mom): Train RMSE=0.2406, Test RMSE=0.1973, CV RMSE=0.4036, Test MAE=0.1307, Test MAPE=0.1300, Best Params={'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, Overfitting Gap=-0.1132, Time=2.19s
2025-05-17 15:00:38,210 - INFO - Hoàn thành SVR trong 2.19s
2025-05-17 15:00:38,673 - INFO - Đã lưu biểu đồ so sánh: cpi_mom_ml_model_comparison.png
2025-05-17 15:00:38,700 - INFO - Kết quả lưu tại ml_model_results\machine_learning_model_results.csv
2025-05-17 15:00:38,703 - INFO - Tham số tối ưu lưu tại ml_model_results\best_params.csv
2025-05-17 15:00:38,710 - INFO - Dự báo kết hợp lưu tại ml_model_results/combined_forecast_cpi_mom.csv
2025-05-17 15:02:41,354 - INFO - Kiểm tra NaN/Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 15:02:41,359 - INFO - Kiểm tra Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 15:02:41,376 - INFO - Kích thước dữ liệu gốc: 349
2025-05-17 15:02:41,376 - INFO - Tạo đặc trưng cho cpi_mom, kích thước dữ liệu: (349, 17)
2025-05-17 15:02:41,416 - INFO - Đã thêm đặc trưng mùa vụ
2025-05-17 15:02:41,454 - INFO - Loại bỏ đặc trưng tương quan thấp (< 0.5): ['cpi_yoy', 'gold_price', 'interest_rate', 'cpi_yoy_smoothed', 'cpi_yoy_log', 'year', 'cpi_mom_diff', 'cpi_mom_rolling_mean', 'cpi_mom_rolling_std', 'cpi_yoy_rolling_mean', 'cpi_yoy_rolling_std', 'cpi_mom_lag_2', 'cpi_mom_lag_3', 'cpi_mom_lag_4', 'cpi_mom_lag_5', 'cpi_mom_lag_6', 'cpi_mom_lag_7', 'cpi_mom_lag_8', 'cpi_mom_lag_9', 'cpi_mom_lag_10', 'cpi_mom_lag_11', 'cpi_mom_lag_12', 'oil_price_lag_1', 'oil_price_lag_2', 'oil_price_lag_3', 'oil_price_lag_4', 'oil_price_lag_5', 'oil_price_lag_6', 'oil_price_lag_7', 'oil_price_lag_8', 'oil_price_lag_9', 'oil_price_lag_10', 'oil_price_lag_11', 'oil_price_lag_12', 'oil_price_roll_mean_3', 'oil_price_roll_mean_6', 'month_1', 'month_2', 'month_3', 'month_4', 'month_5', 'month_6', 'month_7', 'month_8', 'month_9', 'month_10', 'month_11', 'month_12', 'month_sin', 'month_cos', 'quarter']
2025-05-17 15:02:41,491 - INFO - PCA: 4 thành phần, tỷ lệ phương sai: 0.9900
2025-05-17 15:02:41,492 - INFO - Đặc trưng sau xử lý: ['cpi_mom', 'oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:02:41,492 - INFO - Kích thước tập dữ liệu: Train=337, Test=12
2025-05-17 15:02:41,496 - INFO - Đặc trưng cho cpi_mom: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:02:41,521 - INFO - Chạy các mô hình cho cpi_mom
2025-05-17 15:02:41,522 - INFO - Chạy Random Forest cho cpi_mom
2025-05-17 15:02:41,543 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:02:41,545 - INFO - Chạy Random Forest cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:02:54,395 - INFO - Tham số tốt nhất: {'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 10, 'min_samples_split': 10, 'n_estimators': 52}, CV RMSE: 0.4820
2025-05-17 15:02:54,798 - INFO - Đã lưu biểu đồ: cpi_mom_random_forest_forecast.png
2025-05-17 15:02:58,627 - INFO - Đã lưu learning curves: cpi_mom_random_forest_learning_curve.png
2025-05-17 15:02:58,627 - INFO - Overfitting gap cho Random Forest (cpi_mom): 0.0469
2025-05-17 15:02:58,627 - INFO - Random Forest (cpi_mom): Train RMSE=0.3884, Test RMSE=0.2290, CV RMSE=0.4820, Test MAE=0.1661, Test MAPE=0.1656, Best Params={'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 10, 'min_samples_split': 10, 'n_estimators': 52}, Overfitting Gap=0.0469, Time=17.11s
2025-05-17 15:02:58,628 - INFO - Hoàn thành Random Forest trong 17.11s
2025-05-17 15:02:58,628 - INFO - Chạy XGBoost cho cpi_mom
2025-05-17 15:02:58,636 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:02:58,637 - INFO - Chạy XGBoost cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:03:06,103 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, CV RMSE: 0.3662
2025-05-17 15:03:06,522 - INFO - Đã lưu biểu đồ: cpi_mom_xgboost_forecast.png
2025-05-17 15:03:10,054 - INFO - Đã lưu learning curves: cpi_mom_xgboost_learning_curve.png
2025-05-17 15:03:10,054 - INFO - Overfitting gap cho XGBoost (cpi_mom): -0.1197
2025-05-17 15:03:10,054 - INFO - XGBoost (cpi_mom): Train RMSE=0.2598, Test RMSE=0.1934, CV RMSE=0.3662, Test MAE=0.1500, Test MAPE=0.1494, Best Params={'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, Overfitting Gap=-0.1197, Time=11.43s
2025-05-17 15:03:10,054 - INFO - Hoàn thành XGBoost trong 11.43s
2025-05-17 15:03:10,054 - INFO - Chạy LightGBM cho cpi_mom
2025-05-17 15:03:10,061 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:03:10,064 - INFO - Chạy LightGBM cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:03:11,873 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, CV RMSE: 0.4286
2025-05-17 15:03:14,160 - INFO - Đã lưu biểu đồ: cpi_mom_lightgbm_forecast.png
2025-05-17 15:03:15,386 - INFO - Đã lưu learning curves: cpi_mom_lightgbm_learning_curve.png
2025-05-17 15:03:15,386 - INFO - Overfitting gap cho LightGBM (cpi_mom): 0.0252
2025-05-17 15:03:15,386 - INFO - LightGBM (cpi_mom): Train RMSE=0.3235, Test RMSE=0.1795, CV RMSE=0.4286, Test MAE=0.1322, Test MAPE=0.1316, Best Params={'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, Overfitting Gap=0.0252, Time=5.33s
2025-05-17 15:03:15,386 - INFO - Hoàn thành LightGBM trong 5.33s
2025-05-17 15:03:15,386 - INFO - Chạy SVR cho cpi_mom
2025-05-17 15:03:15,393 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:03:15,394 - INFO - Chạy SVR cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:03:17,034 - INFO - Tham số tốt nhất: {'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, CV RMSE: 0.4036
2025-05-17 15:03:17,315 - INFO - Đã lưu biểu đồ: cpi_mom_svr_forecast.png
2025-05-17 15:03:17,767 - INFO - Đã lưu learning curves: cpi_mom_svr_learning_curve.png
2025-05-17 15:03:17,767 - INFO - Overfitting gap cho SVR (cpi_mom): -0.1132
2025-05-17 15:03:17,767 - INFO - SVR (cpi_mom): Train RMSE=0.2406, Test RMSE=0.1973, CV RMSE=0.4036, Test MAE=0.1307, Test MAPE=0.1300, Best Params={'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, Overfitting Gap=-0.1132, Time=2.38s
2025-05-17 15:03:17,767 - INFO - Hoàn thành SVR trong 2.38s
2025-05-17 15:03:17,767 - INFO - Chạy ElasticNet cho cpi_mom
2025-05-17 15:03:17,779 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:03:17,782 - INFO - Chạy ElasticNet cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:03:18,220 - INFO - Tham số tốt nhất: {'alpha': 0.06024145688620425, 'l1_ratio': 0.3325152889039984}, CV RMSE: 0.2862
2025-05-17 15:03:18,470 - INFO - Đã lưu biểu đồ: cpi_mom_elasticnet_forecast.png
2025-05-17 15:03:18,918 - INFO - Đã lưu learning curves: cpi_mom_elasticnet_learning_curve.png
2025-05-17 15:03:18,918 - INFO - Overfitting gap cho ElasticNet (cpi_mom): 0.1367
2025-05-17 15:03:18,918 - INFO - ElasticNet (cpi_mom): Train RMSE=0.3267, Test RMSE=0.2047, CV RMSE=0.2862, Test MAE=0.1559, Test MAPE=0.1552, Best Params={'alpha': 0.06024145688620425, 'l1_ratio': 0.3325152889039984}, Overfitting Gap=0.1367, Time=1.15s
2025-05-17 15:03:18,918 - INFO - Hoàn thành ElasticNet trong 1.15s
2025-05-17 15:03:18,918 - INFO - Chạy Linear Regression cho cpi_mom
2025-05-17 15:03:18,926 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:03:18,927 - INFO - Chạy Linear Regression cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:03:19,213 - INFO - Đã lưu biểu đồ: cpi_mom_linear_regression_forecast.png
2025-05-17 15:03:19,764 - INFO - Đã lưu learning curves: cpi_mom_linear_regression_learning_curve.png
2025-05-17 15:03:19,764 - INFO - Overfitting gap cho Linear Regression (cpi_mom): -1.1440
2025-05-17 15:03:19,764 - INFO - Linear Regression (cpi_mom): Train RMSE=0.3204, Test RMSE=0.2035, CV RMSE=0.3516, Test MAE=0.1426, Test MAPE=0.1419, Best Params={}, Overfitting Gap=-1.1440, Time=0.85s
2025-05-17 15:03:19,765 - INFO - Hoàn thành Linear Regression trong 0.85s
2025-05-17 15:03:19,765 - INFO - Chạy Ridge cho cpi_mom
2025-05-17 15:03:19,773 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:03:19,775 - INFO - Chạy Ridge cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:03:20,198 - INFO - Tham số tốt nhất: {'alpha': 15.061457009902096}, CV RMSE: 0.2860
2025-05-17 15:03:20,436 - INFO - Đã lưu biểu đồ: cpi_mom_ridge_forecast.png
2025-05-17 15:03:20,959 - INFO - Đã lưu learning curves: cpi_mom_ridge_learning_curve.png
2025-05-17 15:03:20,959 - INFO - Overfitting gap cho Ridge (cpi_mom): 0.1621
2025-05-17 15:03:20,959 - INFO - Ridge (cpi_mom): Train RMSE=0.3218, Test RMSE=0.2040, CV RMSE=0.2860, Test MAE=0.1469, Test MAPE=0.1463, Best Params={'alpha': 15.061457009902096}, Overfitting Gap=0.1621, Time=1.19s
2025-05-17 15:03:20,959 - INFO - Hoàn thành Ridge trong 1.19s
2025-05-17 15:03:21,350 - INFO - Đã lưu biểu đồ so sánh: cpi_mom_ml_model_comparison.png
2025-05-17 15:03:21,360 - INFO - Kết quả lưu tại ml_model_results\ml_model_results.csv
2025-05-17 15:03:21,363 - INFO - Tham số tối ưu lưu tại ml_model_results\best_params.csv
2025-05-17 15:03:21,371 - INFO - Dự báo kết hợp lưu tại ml_model_results/combined_forecast_cpi_mom.csv
2025-05-17 15:03:21,495 - INFO - Kiểm tra NaN/Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 15:03:21,496 - INFO - Kiểm tra Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 15:03:21,498 - INFO - Kích thước dữ liệu gốc: 349
2025-05-17 15:03:21,498 - INFO - Tạo đặc trưng cho cpi_mom, kích thước dữ liệu: (349, 17)
2025-05-17 15:03:21,510 - INFO - Đã thêm đặc trưng mùa vụ
2025-05-17 15:03:21,542 - INFO - Loại bỏ đặc trưng tương quan thấp (< 0.5): ['cpi_yoy', 'gold_price', 'interest_rate', 'cpi_yoy_smoothed', 'cpi_yoy_log', 'year', 'cpi_mom_diff', 'cpi_mom_rolling_mean', 'cpi_mom_rolling_std', 'cpi_yoy_rolling_mean', 'cpi_yoy_rolling_std', 'cpi_mom_lag_2', 'cpi_mom_lag_3', 'cpi_mom_lag_4', 'cpi_mom_lag_5', 'cpi_mom_lag_6', 'cpi_mom_lag_7', 'cpi_mom_lag_8', 'cpi_mom_lag_9', 'cpi_mom_lag_10', 'cpi_mom_lag_11', 'cpi_mom_lag_12', 'oil_price_lag_1', 'oil_price_lag_2', 'oil_price_lag_3', 'oil_price_lag_4', 'oil_price_lag_5', 'oil_price_lag_6', 'oil_price_lag_7', 'oil_price_lag_8', 'oil_price_lag_9', 'oil_price_lag_10', 'oil_price_lag_11', 'oil_price_lag_12', 'oil_price_roll_mean_3', 'oil_price_roll_mean_6', 'month_1', 'month_2', 'month_3', 'month_4', 'month_5', 'month_6', 'month_7', 'month_8', 'month_9', 'month_10', 'month_11', 'month_12', 'month_sin', 'month_cos', 'quarter']
2025-05-17 15:03:21,547 - INFO - PCA: 4 thành phần, tỷ lệ phương sai: 0.9900
2025-05-17 15:03:21,548 - INFO - Đặc trưng sau xử lý: ['cpi_mom', 'oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:03:21,548 - INFO - Kích thước tập dữ liệu: Train=337, Test=12
2025-05-17 15:03:21,548 - INFO - Đặc trưng cho cpi_mom: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:03:21,558 - INFO - Chạy các mô hình cho cpi_mom
2025-05-17 15:03:21,558 - INFO - Chạy XGBoost cho cpi_mom
2025-05-17 15:03:21,566 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:03:21,567 - INFO - Chạy XGBoost cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:03:28,223 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, CV RMSE: 0.3662
2025-05-17 15:03:28,542 - INFO - Đã lưu biểu đồ: cpi_mom_xgboost_forecast.png
2025-05-17 15:03:31,797 - INFO - Đã lưu learning curves: cpi_mom_xgboost_learning_curve.png
2025-05-17 15:03:31,797 - INFO - Overfitting gap cho XGBoost (cpi_mom): -0.1197
2025-05-17 15:03:31,797 - INFO - XGBoost (cpi_mom): Train RMSE=0.2598, Test RMSE=0.1934, CV RMSE=0.3662, Test MAE=0.1500, Test MAPE=0.1494, Best Params={'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, Overfitting Gap=-0.1197, Time=10.24s
2025-05-17 15:03:31,797 - INFO - Hoàn thành XGBoost trong 10.24s
2025-05-17 15:03:31,797 - INFO - Chạy LightGBM cho cpi_mom
2025-05-17 15:03:31,805 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:03:31,806 - INFO - Chạy LightGBM cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:03:33,890 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, CV RMSE: 0.4286
2025-05-17 15:03:34,188 - INFO - Đã lưu biểu đồ: cpi_mom_lightgbm_forecast.png
2025-05-17 15:03:35,474 - INFO - Đã lưu learning curves: cpi_mom_lightgbm_learning_curve.png
2025-05-17 15:03:35,474 - INFO - Overfitting gap cho LightGBM (cpi_mom): 0.0252
2025-05-17 15:03:35,474 - INFO - LightGBM (cpi_mom): Train RMSE=0.3235, Test RMSE=0.1795, CV RMSE=0.4286, Test MAE=0.1322, Test MAPE=0.1316, Best Params={'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, Overfitting Gap=0.0252, Time=3.68s
2025-05-17 15:03:35,474 - INFO - Hoàn thành LightGBM trong 3.68s
2025-05-17 15:03:35,474 - INFO - Chạy SVR cho cpi_mom
2025-05-17 15:03:35,483 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:03:35,484 - INFO - Chạy SVR cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:03:37,115 - INFO - Tham số tốt nhất: {'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, CV RMSE: 0.4036
2025-05-17 15:03:37,410 - INFO - Đã lưu biểu đồ: cpi_mom_svr_forecast.png
2025-05-17 15:03:37,979 - INFO - Đã lưu learning curves: cpi_mom_svr_learning_curve.png
2025-05-17 15:03:37,980 - INFO - Overfitting gap cho SVR (cpi_mom): -0.1132
2025-05-17 15:03:37,980 - INFO - SVR (cpi_mom): Train RMSE=0.2406, Test RMSE=0.1973, CV RMSE=0.4036, Test MAE=0.1307, Test MAPE=0.1300, Best Params={'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, Overfitting Gap=-0.1132, Time=2.51s
2025-05-17 15:03:37,980 - INFO - Hoàn thành SVR trong 2.51s
2025-05-17 15:03:38,340 - INFO - Đã lưu biểu đồ so sánh: cpi_mom_ml_model_comparison.png
2025-05-17 15:03:38,348 - INFO - Kết quả lưu tại ml_model_results\machine_learning_model_results.csv
2025-05-17 15:03:38,350 - INFO - Tham số tối ưu lưu tại ml_model_results\best_params.csv
2025-05-17 15:03:38,355 - INFO - Dự báo kết hợp lưu tại ml_model_results/combined_forecast_cpi_mom.csv
2025-05-17 15:04:10,061 - INFO - Kiểm tra NaN/Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 15:04:10,061 - INFO - Kiểm tra Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 15:04:10,063 - INFO - Kích thước dữ liệu gốc: 349
2025-05-17 15:04:10,063 - INFO - Tạo đặc trưng cho cpi_mom, kích thước dữ liệu: (349, 17)
2025-05-17 15:04:10,073 - INFO - Đã thêm đặc trưng mùa vụ
2025-05-17 15:04:10,109 - INFO - Loại bỏ đặc trưng tương quan thấp (< 0.5): ['cpi_yoy', 'gold_price', 'interest_rate', 'cpi_yoy_smoothed', 'cpi_yoy_log', 'year', 'cpi_mom_diff', 'cpi_mom_rolling_mean', 'cpi_mom_rolling_std', 'cpi_yoy_rolling_mean', 'cpi_yoy_rolling_std', 'cpi_mom_lag_2', 'cpi_mom_lag_3', 'cpi_mom_lag_4', 'cpi_mom_lag_5', 'cpi_mom_lag_6', 'cpi_mom_lag_7', 'cpi_mom_lag_8', 'cpi_mom_lag_9', 'cpi_mom_lag_10', 'cpi_mom_lag_11', 'cpi_mom_lag_12', 'oil_price_lag_1', 'oil_price_lag_2', 'oil_price_lag_3', 'oil_price_lag_4', 'oil_price_lag_5', 'oil_price_lag_6', 'oil_price_lag_7', 'oil_price_lag_8', 'oil_price_lag_9', 'oil_price_lag_10', 'oil_price_lag_11', 'oil_price_lag_12', 'oil_price_roll_mean_3', 'oil_price_roll_mean_6', 'month_1', 'month_2', 'month_3', 'month_4', 'month_5', 'month_6', 'month_7', 'month_8', 'month_9', 'month_10', 'month_11', 'month_12', 'month_sin', 'month_cos', 'quarter']
2025-05-17 15:04:10,114 - INFO - PCA: 4 thành phần, tỷ lệ phương sai: 0.9900
2025-05-17 15:04:10,115 - INFO - Đặc trưng sau xử lý: ['cpi_mom', 'oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:04:10,116 - INFO - Kích thước tập dữ liệu: Train=337, Test=12
2025-05-17 15:04:10,116 - INFO - Đặc trưng cho cpi_mom: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:04:10,127 - INFO - Chạy các mô hình cho cpi_mom
2025-05-17 15:04:10,127 - INFO - Chạy Random Forest cho cpi_mom
2025-05-17 15:04:10,136 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:04:10,137 - INFO - Chạy Random Forest cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:04:23,223 - INFO - Tham số tốt nhất: {'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 10, 'min_samples_split': 10, 'n_estimators': 52}, CV RMSE: 0.4820
2025-05-17 15:04:23,839 - INFO - Đã lưu biểu đồ: cpi_mom_random_forest_forecast.png
2025-05-17 15:04:27,755 - INFO - Đã lưu learning curves: cpi_mom_random_forest_learning_curve.png
2025-05-17 15:04:27,755 - INFO - Overfitting gap cho Random Forest (cpi_mom): 0.0469
2025-05-17 15:04:27,755 - INFO - Random Forest (cpi_mom): Train RMSE=0.3884, Test RMSE=0.2290, CV RMSE=0.4820, Test MAE=0.1661, Test MAPE=0.1656, Best Params={'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 10, 'min_samples_split': 10, 'n_estimators': 52}, Overfitting Gap=0.0469, Time=17.63s
2025-05-17 15:04:27,755 - INFO - Hoàn thành Random Forest trong 17.63s
2025-05-17 15:04:27,755 - INFO - Chạy XGBoost cho cpi_mom
2025-05-17 15:04:27,766 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:04:27,767 - INFO - Chạy XGBoost cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:04:35,137 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, CV RMSE: 0.3662
2025-05-17 15:04:35,537 - INFO - Đã lưu biểu đồ: cpi_mom_xgboost_forecast.png
2025-05-17 15:04:39,565 - INFO - Đã lưu learning curves: cpi_mom_xgboost_learning_curve.png
2025-05-17 15:04:39,568 - INFO - Overfitting gap cho XGBoost (cpi_mom): -0.1197
2025-05-17 15:04:39,569 - INFO - XGBoost (cpi_mom): Train RMSE=0.2598, Test RMSE=0.1934, CV RMSE=0.3662, Test MAE=0.1500, Test MAPE=0.1494, Best Params={'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, Overfitting Gap=-0.1197, Time=11.81s
2025-05-17 15:04:39,579 - INFO - Hoàn thành XGBoost trong 11.82s
2025-05-17 15:04:39,579 - INFO - Chạy LightGBM cho cpi_mom
2025-05-17 15:04:39,613 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:04:39,641 - INFO - Chạy LightGBM cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:04:42,972 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, CV RMSE: 0.4286
2025-05-17 15:04:43,269 - INFO - Đã lưu biểu đồ: cpi_mom_lightgbm_forecast.png
2025-05-17 15:04:44,303 - INFO - Đã lưu learning curves: cpi_mom_lightgbm_learning_curve.png
2025-05-17 15:04:44,304 - INFO - Overfitting gap cho LightGBM (cpi_mom): 0.0252
2025-05-17 15:04:44,304 - INFO - LightGBM (cpi_mom): Train RMSE=0.3235, Test RMSE=0.1795, CV RMSE=0.4286, Test MAE=0.1322, Test MAPE=0.1316, Best Params={'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, Overfitting Gap=0.0252, Time=4.72s
2025-05-17 15:04:44,304 - INFO - Hoàn thành LightGBM trong 4.72s
2025-05-17 15:04:44,304 - INFO - Chạy SVR cho cpi_mom
2025-05-17 15:04:44,313 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:04:44,315 - INFO - Chạy SVR cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:04:45,880 - INFO - Tham số tốt nhất: {'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, CV RMSE: 0.4036
2025-05-17 15:04:46,120 - INFO - Đã lưu biểu đồ: cpi_mom_svr_forecast.png
2025-05-17 15:04:46,623 - INFO - Đã lưu learning curves: cpi_mom_svr_learning_curve.png
2025-05-17 15:04:46,625 - INFO - Overfitting gap cho SVR (cpi_mom): -0.1132
2025-05-17 15:04:46,625 - INFO - SVR (cpi_mom): Train RMSE=0.2406, Test RMSE=0.1973, CV RMSE=0.4036, Test MAE=0.1307, Test MAPE=0.1300, Best Params={'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, Overfitting Gap=-0.1132, Time=2.32s
2025-05-17 15:04:46,625 - INFO - Hoàn thành SVR trong 2.32s
2025-05-17 15:04:46,625 - INFO - Chạy ElasticNet cho cpi_mom
2025-05-17 15:04:46,636 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:04:46,637 - INFO - Chạy ElasticNet cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:04:47,203 - INFO - Tham số tốt nhất: {'alpha': 0.06024145688620425, 'l1_ratio': 0.3325152889039984}, CV RMSE: 0.2862
2025-05-17 15:04:47,466 - INFO - Đã lưu biểu đồ: cpi_mom_elasticnet_forecast.png
2025-05-17 15:04:47,914 - INFO - Đã lưu learning curves: cpi_mom_elasticnet_learning_curve.png
2025-05-17 15:04:47,914 - INFO - Overfitting gap cho ElasticNet (cpi_mom): 0.1367
2025-05-17 15:04:47,914 - INFO - ElasticNet (cpi_mom): Train RMSE=0.3267, Test RMSE=0.2047, CV RMSE=0.2862, Test MAE=0.1559, Test MAPE=0.1552, Best Params={'alpha': 0.06024145688620425, 'l1_ratio': 0.3325152889039984}, Overfitting Gap=0.1367, Time=1.29s
2025-05-17 15:04:47,914 - INFO - Hoàn thành ElasticNet trong 1.29s
2025-05-17 15:04:47,914 - INFO - Chạy Linear Regression cho cpi_mom
2025-05-17 15:04:47,921 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:04:47,922 - INFO - Chạy Linear Regression cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:04:48,212 - INFO - Đã lưu biểu đồ: cpi_mom_linear_regression_forecast.png
2025-05-17 15:04:48,600 - INFO - Đã lưu learning curves: cpi_mom_linear_regression_learning_curve.png
2025-05-17 15:04:48,600 - INFO - Overfitting gap cho Linear Regression (cpi_mom): -1.1440
2025-05-17 15:04:48,601 - INFO - Linear Regression (cpi_mom): Train RMSE=0.3204, Test RMSE=0.2035, CV RMSE=0.3516, Test MAE=0.1426, Test MAPE=0.1419, Best Params={}, Overfitting Gap=-1.1440, Time=0.69s
2025-05-17 15:04:48,601 - INFO - Hoàn thành Linear Regression trong 0.69s
2025-05-17 15:04:48,601 - INFO - Chạy Ridge cho cpi_mom
2025-05-17 15:04:48,606 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:04:48,609 - INFO - Chạy Ridge cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:04:49,067 - INFO - Tham số tốt nhất: {'alpha': 15.061457009902096}, CV RMSE: 0.2860
2025-05-17 15:04:49,411 - INFO - Đã lưu biểu đồ: cpi_mom_ridge_forecast.png
2025-05-17 15:04:49,813 - INFO - Đã lưu learning curves: cpi_mom_ridge_learning_curve.png
2025-05-17 15:04:49,814 - INFO - Overfitting gap cho Ridge (cpi_mom): 0.1621
2025-05-17 15:04:49,814 - INFO - Ridge (cpi_mom): Train RMSE=0.3218, Test RMSE=0.2040, CV RMSE=0.2860, Test MAE=0.1469, Test MAPE=0.1463, Best Params={'alpha': 15.061457009902096}, Overfitting Gap=0.1621, Time=1.21s
2025-05-17 15:04:49,814 - INFO - Hoàn thành Ridge trong 1.21s
2025-05-17 15:04:50,129 - INFO - Đã lưu biểu đồ so sánh: cpi_mom_ml_model_comparison.png
2025-05-17 15:04:50,141 - INFO - Kết quả lưu tại ml_model_results\ml_model_results.csv
2025-05-17 15:04:50,144 - INFO - Tham số tối ưu lưu tại ml_model_results\best_params.csv
2025-05-17 15:04:50,153 - INFO - Dự báo kết hợp lưu tại ml_model_results/combined_forecast_cpi_mom.csv
2025-05-17 15:04:50,282 - INFO - Kiểm tra NaN/Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 15:04:50,283 - INFO - Kiểm tra Inf trong dữ liệu gốc: {'cpi_mom': 0, 'oil_price': 0}
2025-05-17 15:04:50,287 - INFO - Kích thước dữ liệu gốc: 349
2025-05-17 15:04:50,287 - INFO - Tạo đặc trưng cho cpi_mom, kích thước dữ liệu: (349, 17)
2025-05-17 15:04:50,303 - INFO - Đã thêm đặc trưng mùa vụ
2025-05-17 15:04:50,338 - INFO - Loại bỏ đặc trưng tương quan thấp (< 0.5): ['cpi_yoy', 'gold_price', 'interest_rate', 'cpi_yoy_smoothed', 'cpi_yoy_log', 'year', 'cpi_mom_diff', 'cpi_mom_rolling_mean', 'cpi_mom_rolling_std', 'cpi_yoy_rolling_mean', 'cpi_yoy_rolling_std', 'cpi_mom_lag_2', 'cpi_mom_lag_3', 'cpi_mom_lag_4', 'cpi_mom_lag_5', 'cpi_mom_lag_6', 'cpi_mom_lag_7', 'cpi_mom_lag_8', 'cpi_mom_lag_9', 'cpi_mom_lag_10', 'cpi_mom_lag_11', 'cpi_mom_lag_12', 'oil_price_lag_1', 'oil_price_lag_2', 'oil_price_lag_3', 'oil_price_lag_4', 'oil_price_lag_5', 'oil_price_lag_6', 'oil_price_lag_7', 'oil_price_lag_8', 'oil_price_lag_9', 'oil_price_lag_10', 'oil_price_lag_11', 'oil_price_lag_12', 'oil_price_roll_mean_3', 'oil_price_roll_mean_6', 'month_1', 'month_2', 'month_3', 'month_4', 'month_5', 'month_6', 'month_7', 'month_8', 'month_9', 'month_10', 'month_11', 'month_12', 'month_sin', 'month_cos', 'quarter']
2025-05-17 15:04:50,347 - INFO - PCA: 4 thành phần, tỷ lệ phương sai: 0.9900
2025-05-17 15:04:50,348 - INFO - Đặc trưng sau xử lý: ['cpi_mom', 'oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:04:50,348 - INFO - Kích thước tập dữ liệu: Train=337, Test=12
2025-05-17 15:04:50,348 - INFO - Đặc trưng cho cpi_mom: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:04:50,358 - INFO - Chạy các mô hình cho cpi_mom
2025-05-17 15:04:50,358 - INFO - Chạy XGBoost cho cpi_mom
2025-05-17 15:04:50,369 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:04:50,371 - INFO - Chạy XGBoost cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:04:56,940 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, CV RMSE: 0.3662
2025-05-17 15:04:57,369 - INFO - Đã lưu biểu đồ: cpi_mom_xgboost_forecast.png
2025-05-17 15:05:00,818 - INFO - Đã lưu learning curves: cpi_mom_xgboost_learning_curve.png
2025-05-17 15:05:00,818 - INFO - Overfitting gap cho XGBoost (cpi_mom): -0.1197
2025-05-17 15:05:00,818 - INFO - XGBoost (cpi_mom): Train RMSE=0.2598, Test RMSE=0.1934, CV RMSE=0.3662, Test MAE=0.1500, Test MAPE=0.1494, Best Params={'colsample_bytree': 0.8123620356542087, 'learning_rate': 0.05753571532049581, 'max_depth': 3, 'min_child_weight': 5, 'n_estimators': 70, 'reg_alpha': 0.6560186404424365, 'reg_lambda': 1.7799726016810133, 'subsample': 0.7174250836504598}, Overfitting Gap=-0.1197, Time=10.46s
2025-05-17 15:05:00,818 - INFO - Hoàn thành XGBoost trong 10.46s
2025-05-17 15:05:00,818 - INFO - Chạy LightGBM cho cpi_mom
2025-05-17 15:05:00,828 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:05:00,830 - INFO - Chạy LightGBM cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:05:03,142 - INFO - Tham số tốt nhất: {'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, CV RMSE: 0.4286
2025-05-17 15:05:03,574 - INFO - Đã lưu biểu đồ: cpi_mom_lightgbm_forecast.png
2025-05-17 15:05:04,867 - INFO - Đã lưu learning curves: cpi_mom_lightgbm_learning_curve.png
2025-05-17 15:05:04,868 - INFO - Overfitting gap cho LightGBM (cpi_mom): 0.0252
2025-05-17 15:05:04,868 - INFO - LightGBM (cpi_mom): Train RMSE=0.3235, Test RMSE=0.1795, CV RMSE=0.4286, Test MAE=0.1322, Test MAPE=0.1316, Best Params={'colsample_bytree': 0.9687290787020557, 'lambda_l1': 2.8768511159105588, 'lambda_l2': 3.3163778598819182, 'learning_rate': 0.04477580432130638, 'max_depth': 3, 'min_data_in_leaf': 20, 'n_estimators': 88, 'subsample': 0.8231148769106889}, Overfitting Gap=0.0252, Time=4.05s
2025-05-17 15:05:04,868 - INFO - Hoàn thành LightGBM trong 4.05s
2025-05-17 15:05:04,868 - INFO - Chạy SVR cho cpi_mom
2025-05-17 15:05:04,881 - INFO - Đặc trưng được chọn: ['oil_price', 'pca_1', 'pca_2', 'pca_3', 'pca_4']
2025-05-17 15:05:04,882 - INFO - Chạy SVR cho cpi_mom, X_train shape: (337, 5)
2025-05-17 15:05:06,508 - INFO - Tham số tốt nhất: {'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, CV RMSE: 0.4036
2025-05-17 15:05:06,767 - INFO - Đã lưu biểu đồ: cpi_mom_svr_forecast.png
2025-05-17 15:05:07,285 - INFO - Đã lưu learning curves: cpi_mom_svr_learning_curve.png
2025-05-17 15:05:07,285 - INFO - Overfitting gap cho SVR (cpi_mom): -0.1132
2025-05-17 15:05:07,285 - INFO - SVR (cpi_mom): Train RMSE=0.2406, Test RMSE=0.1973, CV RMSE=0.4036, Test MAE=0.1307, Test MAPE=0.1300, Best Params={'C': 1.1292247147901224, 'epsilon': 0.10699098521619943, 'kernel': 'rbf'}, Overfitting Gap=-0.1132, Time=2.42s
2025-05-17 15:05:07,285 - INFO - Hoàn thành SVR trong 2.42s
2025-05-17 15:05:07,626 - INFO - Đã lưu biểu đồ so sánh: cpi_mom_ml_model_comparison.png
2025-05-17 15:05:07,634 - INFO - Kết quả lưu tại machine_learning_model_results\machine_learning_model_results.csv
2025-05-17 15:05:07,636 - INFO - Tham số tối ưu lưu tại machine_learning_model_results\best_params.csv
2025-05-17 15:05:07,639 - INFO - Dự báo kết hợp lưu tại machine_learning_model_results/combined_forecast_cpi_mom.csv
